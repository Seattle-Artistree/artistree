<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Artistree</title>
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<style type="text/css">
			#login, #loggedin {
				display: none;
			}
			.text-overflow {
				overflow: hidden;
				text-overflow: ellipsis;
				white-space: nowrap;
				width: 500px;
			}
			</style>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" type="text/css" media="screen" href="reset.css" />
		<link rel="stylesheet" type="text/css" media="screen" href="base.css" />
		<link rel="stylesheet" type="text/css" media="screen" href="layout.css" />
		<link rel="stylesheet" type="text/css" media="screen" href="module.css" />
		<script src="https://d3js.org/d3.v3.min.js"></script>
		
		<!-- Application Templates -->
		<script id="user-profile-template" type="text/x-handlebars-template">
			<h1>Logged in as {{display_name}}</h1>
			<div class="media">
				<div class="pull-left">
					<img class="media-object" width="150" src="{{images.0.url}}" />
				</div>
				<div class="media-body">
					<dl class="dl-horizontal">
						<dt>Artist name</dt><dd class="clearfix">{{name}}</dd>
						<dt>Id</dt><dd>{{id}}</dd>
						<!-- <dt>Email</dt><dd>{{email}}</dd>
						<dt>Spotify URI</dt><dd><a href="{{external_urls.spotify}}">{{external_urls.spotify}}</a></dd>
						<dt>Link</dt><dd><a href="{{href}}">{{href}}</a></dd>
						<dt>Profile Image</dt><dd class="clearfix"><a href="{{images.0.url}}">{{images.0.url}}</a></dd>
						<dt>Country</dt><dd>{{country}}</dd> -->
					</dl>
				</div>
			</div>
		</script>
		
		<script id="oauth-template" type="text/x-handlebars-template">
			<h2>oAuth info</h2>
			<dl class="dl-horizontal">
				<dt>Access token</dt><dd class="text-overflow">{{access_token}}</dd>
				<dt>Refresh token</dt><dd class="text-overflow">{{refresh_token}}</dd>
			</dl>
		</script>
		
		<script type="text/x-handlebars-template" id="error-template">
			<h3>Oops, something went wrong!</h3>
			<p>{{status}}: {{statusText}}</p>
		</script>
		
	</head>

	<body>
		<!-- Header needs data-content and classes renamed -->
		<header>
			<div class="header-content">
				<a href="/"><img src="http://via.placeholder.com/100x100" alt="logo"></a>
				<h2>Artistree</h2>
			</div>
			<nav class="main-nav">
				<div class="icon-menu"></div>
				<ul>
					<li class="tab" data-content="books"><a href="/" class="icon-home"> Home</a></li>
					<li class="tab" data-content="new"><a href="/new" class="icon-address-book">About Us</a></li>
				</ul>
			</nav>
		</header>
		
		<main>
			<div class="container">
				<div id="login">
					<h1>Welcome to Artistree</h1>
					<a href="/login" class="btn btn-primary">Log in with Spotify</a>
				</div>
				<div id="loggedin">
					<div id="user-profile">
					</div>
					<div id="oauth">
					</div>
					<button class="btn btn-default" id="obtain-new-token">Obtain new token using the refresh token</button>
				</div>
			</div>

			<section class="error-view container">
				<h2 class="view-title">Oh noes, we messed up!</h2>
				<section id="error-message"></section>
			</section>
			
			<section class="landing-view container">
				<h1 class="main-view-title">Artistree</h1>
				
			</section>
			
			<section class="home-view container">
				<!-- <h2 class="view-title">Explore</h2>
				<section class="nodes-box">
					<ul id="node-list"></ul>
				</section> -->
				
				<!-- load the d3.js library -->	
				<script>
					var margin = {top: 20, right: 120, bottom: 20, left: 120},
					width = 960 - margin.right - margin.left,
					height = 800 - margin.top - margin.bottom;

					var i = 0,
							duration = 750,
							root;

					var tree = d3.layout.tree()
							.size([height, width]);

					var diagonal = d3.svg.diagonal()
							.projection(function(d) { return [d.x, d.y]; });

					var svg = d3.select("body").append("svg")
							.attr("width", width + margin.right + margin.left)
							.attr("height", height + margin.top + margin.bottom)
						.append("g")
							.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

					d3.json("flare.json", function(error, flare) {
						if (error) throw error;

						root = flare;
						root.x0 = height / 2;
						root.y0 = 0;

						function collapse(d) {
							if (d.children) {
								d._children = d.children;
								d._children.forEach(collapse);
								d.children = null;
							}
						}

						root.children.forEach(collapse);
						update(root);
					});

					d3.select(self.frameElement).style("height", "800px");

					function update(source) {

						// Compute the new tree layout.
						var nodes = tree.nodes(root).reverse(),
								links = tree.links(nodes);

						// Normalize for fixed-depth.
						nodes.forEach(function(d) { d.y = d.depth * 100; });

						// Update the nodes…
						var node = svg.selectAll("g.node")
								.data(nodes, function(d) { return d.id || (d.id = ++i); });

						// Enter any new nodes at the parent's previous position.
						var nodeEnter = node.enter().append("g")
								.attr("class", "node")
								.attr("transform", function(d) { return "translate(" + source.x0 + "," + source.y0 + ")"; })
								.on("click", click);

						nodeEnter.append("circle")
								.attr("r", 1e-6)
								.style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

						nodeEnter.append("text")
								.attr("y", function(d) { return d.children || d._children ? -15 : 15; })
								.attr("dy", ".35em")
								// .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
								.attr("text-anchor", "middle")
								.text(function(d) { return d.name; })
								.style("fill-opacity", 1e-6);

						// Transition nodes to their new position.
						var nodeUpdate = node.transition()
								.duration(duration)
								.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

						nodeUpdate.select("circle")
								.attr("r", 4.5)
								.style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

						nodeUpdate.select("text")
								.style("fill-opacity", 1);

						// Transition exiting nodes to the parent's new position.
						var nodeExit = node.exit().transition()
								.duration(duration)
								.attr("transform", function(d) { return "translate(" + source.x + "," + source.y + ")"; })
								.remove();

						nodeExit.select("circle")
								.attr("r", 1e-6);

						nodeExit.select("text")
								.style("fill-opacity", 1e-6);

						// Update the links…
						var link = svg.selectAll("path.link")
								.data(links, function(d) { return d.target.id; });

						// Enter any new links at the parent's previous position.
						link.enter().insert("path", "g")
								.attr("class", "link")
								.attr("d", function(d) {
									var o = {x: source.x0, y: source.y0};
									return diagonal({source: o, target: o});
								});

						// Transition links to their new position.
						link.transition()
								.duration(duration)
								.attr("d", diagonal);

						// Transition exiting nodes to the parent's new position.
						link.exit().transition()
								.duration(duration)
								.attr("d", function(d) {
									var o = {x: source.x, y: source.y};
									return diagonal({source: o, target: o});
								})
								.remove();

						// Stash the old positions for transition.
						nodes.forEach(function(d) {
							d.x0 = d.x;
							d.y0 = d.y;
						});
					}

					// Toggle children on click.
					function click(d) {
						if (d.children) {
							d._children = d.children;
							d.children = null;
						} else {
							d.children = d._children;
							d._children = null;
						}
						update(d);
					}
				
				</script>

			</section>






<section class="about-view container">
	<h2 class="feedback-title">Questions, Comments, Suggestions?</h2>
	<form id="feedback">
		<input type="text" id="title" placeholder="title" /><br>
		<input type="text" id="comment" placeholder="feedback" /><br>
		<button type="submit">Submit</button>
		
		<!-- Need Photos and Bios!!! -->
		
	</form>
</section>	
</main>

		<footer>
			<aside class="social-links">
				<ul>
					<li><i class="icon-mail2"><a href=""></a></i></li>
					<li><i class="icon-twitter"><a href=""></a></i></li>
					<li><i class="icon-github"><a href=""></a></i></li>
					<li><i class="icon-linkedin2"><a href=""></a></i></li>
				</ul>
			</aside>
		</footer>
		
		<!-- External CDN Resources -->
		<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
		<script src="https://cdn.rawgit.com/visionmedia/page.js/master/page.js"></script>
		<!-- Application Resources -->
		<script src="scripts/controllers/routes.js"></script>
		<script src="scripts/views/error-view.js"></script>
		<script src="scripts/view/home.js"></script>
		
		<script src="scripts/controllers/auth-template.js"></script>
		
		
	</body>
</html>